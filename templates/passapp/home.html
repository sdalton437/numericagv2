<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="Sadanand Shinde">
    <!--<link rel="icon" href="../../favicon.ico">-->

    <title>NumericAg,Home</title>
    <script type='text/javascript' src='http://knockoutjs.com/downloads/knockout-3.4.2.js'></script>



  {% load static %}
    {% include "passapp/base.html" %}

      <!--  javascript function to add option value as years to season variable-->
      <script type="text/javascript">
            $(document).ready(function(){

                //Min Values
                var minCHU = 550;
                var maxCHU = 950;
                var minTillType = {{ minTillType }};
                var maxTillType = {{ maxTillType }};
                var minPrevCrop = {{ minPrevCrop }};
                var maxPrevCrop = {{ maxPrevCrop }};
                var minAWDR = 15;
                var maxAWDR = 135;
                var minSOM = 1;
                var maxSOM = 12;
                var minClayRatio = 0.0323;
                var maxClayRatio = 0.8824;

                //User Parameters
                var userTillage = {{ userTillage }};
                var userPrevCrop = {{ userPrevCrop }};
                var userClayRatio = {{ userClayRatio }};
                var userSOM = {{ userSOM }};
                var userCHU = {{ userCHU }};
                var userAWDR = {{ userAWDR }};



             $("#chuMin").val({{ minCHU }});
             $("#chuMax").val({{ maxCHU }});



           //$("#tillTypeMin").val({{ minTillType }});
            //$("#tillTypeMax").val({{ maxTillType }});

              //$("#prevCropMin").val({{ minPrevCrop }});
             //$("#prevCropMax").val({{ maxPrevCrop }});

             $("#climateMin").val({{ minAWDR }});
             $("#climateMax").val({{ maxAWDR }});


               $("#somMin").val({{ minSOM }});
             $("#somMax").val({{ maxSOM }});

             $("#soilTypeMin").val({{ minClayRatio }});
             $("#soilTypeMax").val({{ maxClayRAtio }});

          //default hide the other text values and show only if other is selected as value
           $("input#somother").hide();
           $("input#chuother").hide();
           $("input#awdrother").hide();

            //code to show/hide som other textbox value based on the user selection at SOM class
            $('#som').change(function() {
            var selected = $(this).val();
            if(selected == 'other'){
            $('#somother').show();
            }
            else{
                $('#somother').hide();
            }
            });

                //code to show/hide chu other textbox value based on the user selection at CHU class
            $('#chu').change(function() {
            var selected = $(this).val();
            if(selected == 'other'){
            $('#chuother').show();
            }
            else{
                $('#chuother').hide();
            }
            });

                 //code to show/hide chu other textbox value based on the user selection at CHU class
            $('#climate').change(function() {
            var selected = $(this).val();
            if(selected == 'other'){
            $('#awdrother').show();
            }
            else{
                $('#awdrother').hide();
            }
            });

       });
  function addSeasonOption(){
  var max = new Date().getFullYear(),
     min = max - 7,
    select = document.getElementById('season');

  for (var i = max; i>=min; i--){
    var opt = document.createElement('option');
    opt.value = i;
    opt.innerHTML = i;
    select.appendChild(opt);
    }
    }
    window.onload = addSeasonOption;

  </script>

      <!-- Knockout JS -->
      <script type="text/javascript">
          /*
          var cropData = [
              {title: "Min Soil Distortion (No till)" , value: 1.00, scale: },
              {title:"Max Soil Distortion (Conventional)" , value: 0.9, scale:},
              {title: "Low nutrient contribution (e.g., Corn, Potatoes etc.)", value:0.50, scale: },
              {title: "Moderate nutrient contribution (e.g., Soybean, Forage etc.)", value: 0.75, scale:},
              {title: "Strong nutrient contribution (e.g., Legumes, GreenPeas etc.)", value: 1.00, scale:}
          ];

*/


          var minCHU = 550;
                var maxCHU = 950;
                var minTillType = {{ minTillType }};
                var maxTillType = {{ maxTillType }};
                var minPrevCrop = {{ minPrevCrop }};
                var maxPrevCrop = {{ maxPrevCrop }};
                var minAWDR = 15;
                var maxAWDR = 135;
                var minSOM = 1;
                var maxSOM = 12;
                var minClayRatio = 0.0323;
                var maxClayRatio = 0.8824;
                var TillTypeTmp = 0.5;
                var PrevCropTmp = 0.5;
                var AWDRTmp = 75;
                var SOMTmp = 5;
                var ClayRatioTmp = 0.6667;
                var CHUTmp = 750;

                /*
          var Category = function(name, value, min, max){
              this.name = name;
              this.value = ko.observable(value);
              this.min = ko.observable(min);
              this.max = ko.observable(max);
              this.scale = ko.computed(function(){
                  return +((this.value()+this.min())/(this.max() + this.min())).toFixed(2);
              },this);
          };

          var TillType = function(name,value){
              this.name = name;
              this.value = ko.observable(value);
          };

          var CropContribution = function(name,value){
              this.name = name;
              this.value = ko.observable(value);
          };

          var tillTypes = ko.observableArray([
                  new TillType("Min Soil Distortion (No till)",1.00),
                  new TillType("Max Soil Distortion (Conventional)",0.9)
              ]);

          var cropContributions = ko.observableArray([
                  new CropContribution("Low nutrient contribution (e.g., Corn, Potatoes etc.)", 0.50),
                  new CropContribution("Moderate nutrient contribution (e.g., Soybean, Forage etc.)",0.75),
                  new CropContribution("Strong nutrient contribution (e.g., Legumes, GreenPeas etc.)",1.00)
              ]);
          var selectedPrevCrop = ko.observable(PrevCropTmp);
          var Categories = ko.observableArray([
                  new Category("TillType",TillTypeTmp,minTillType,maxTillType),
                  new Category("PrevCropContribution",selectedPrevCrop(),cropContributions()[0].value(),cropContributions()[2].value()),
                  new Category("ClayRatio",ClayRatioTmp,minClayRatio,maxClayRatio),
                  new Category("SOM",SOMTmp,minSOM,maxSOM),
                  new Category("AWDR",AWDRTmp,minAWDR,maxAWDR),
                  new Category("CHU",CHUTmp,minCHU,maxCHU)
              ]);
          console.log("val: " + cropContributions()[0].value());
        */
          var ViewModel = function(){
               var minCHU = ko.observable(550);
                var maxCHU = ko.observable(950);
                this.tillTypek = ko.observable(1);
                this.minTillTypek = ko.observable({{ maxTillType }});
                this.maxTillTypek = ko.observable({{ minTillType }});
                this.prevCropSelected = ko.observable(0.5);

                this.lowPrevCrop = ko.observable(0);
                this.modPrevCrop = ko.observable(50);
                this.highPrevCrop = ko.observable(100);

                this.prevCropMink = ko.observable({{ minPrevCrop }});
                this.prevCropMaxk = ko.observable({{ maxPrevCrop }});

                this.minPrevCropk = ko.observable({{ minPrevCrop }});
                this.maxPrevCropk = ko.observable({{ maxPrevCrop }});
                var minAWDR = ko.observable(15);
                var maxAWDR = ko.observable(135);
                var minSOM = ko.observable(1);
                var maxSOM = ko.observable(12);
                var minClayRatio = ko.observable(0.0323);
                var maxClayRatio = ko.observable(0.8824);
                var TillTypeTmp = ko.observable(0.5);
                var PrevCropTmp = ko.observable(0.5);
                var AWDRTmp = ko.observable(75);
                var SOMTmp = ko.observable(5);
                var ClayRatioTmp = ko.observable(0.6667);
                var CHUTmp = ko.observable(750);
                this.tillTypeScalek = ko.computed(function(){
                    return ((this.tillTypek()-this.minTillTypek())/(this.maxTillTypek()-this.minTillTypek()));},this);
                this.prevCropScalek = ko.computed(function(){
                    return ((this.prevCropSelected()-this.minPrevCropk())/(this.maxPrevCropk()-this.minPrevCropk()));},this);





                /*
              var self = this;
              this.items = ko.observableArray();
              cropData.forEach(function(data)){
                  var item = [
                      {title: data.title, value: ko.observable(data.value), scale: ko.computed(function(){
                  return +((data.value+data.min)/(data.max + data.min)).toFixed(2);
              },this);}
                  ]
                  self.items.push(data);
              }
              this.selectedPrevCrop : ko.observable(PrevCropTmp),
              cropContributions : ko.observable(cropContributions),
              */



          };


          </script>
    <style>

    fieldset.scheduler-border {
    border: solid 1px #DDD !important;
    padding: 0 10px 10px 10px;
    border-bottom: none;

    }

    legend.scheduler-border {
    width: auto !important;
    border: none;
    font-size: 16px;
    font: inherit;
    font-weight: bold;
    line-height: 1.42857143;
    color: #555;
    padding-top: 5px;
    }


    </style>




    <script src="https://code.jquery.com/jquery-1.10.2.js"></script>
  </head>

  <body>


    <div class="container theme-showcase" role="main">

      <!-- Main jumbotron for a primary marketing message or call to action -->
      <div class="jumbotron">
       <!--  <h2>Welcome to Precision Agriculture!</h2>-->
        <p> <strong>NumericAg</strong> is a decision support system designed to help farmers and their consultants identify the least risky site-specific rate of key agricultural inputs, such as nitrogen fertilizer.
            This numeric simulation process integrates previous fertility trial records, information about local conditions and economic considerations to estimate probable net return over cost of fertilization.
            Please enter your data below and submit the form. Certain inputs mean maximum accuracy in results.
    </p>

   </div> <!--'jumbotron'-->
        {% block content %}


            <div class="panel panel-primary">
                <div class="panel-heading">
               <h3 class="panel-title">Please select/fill the most appropriate option specific to your farming conditions and click on submit. &nbsp;<small>(Results will be sent on the registered email Id)</small></h3>
                </div>
                <div class="panel-body">
                    <p>
                        <small>  <a href="description"> Please click on the question marks(?) to find the descriptions of the corresponding parameters</a></small>
                    </p>
                  {% if messages %}

                        {% for message in messages %}
                          <div id="output2"{% if message.tags == "error" %} class="label label-danger"{%  else %} class="label label-success" {% endif %}>{{ message }} </div>
                        {% endfor %}

                    {% endif %}

                      <form role= "form" action="{% url 'saveUserRequest' %}" method="post">
                        {% csrf_token %}


                        <div class="row">
                            <div class="col-xs-6 col-sm-6 col-md-6">
                                <div class="form-group">

                    <label for="fertilizer">Fertilizer</label>
                    <select class="form-control" id="fertilizer" name="fertilizer" >
                      <option value="Nitrogen">Nitrogen</option>
                    </select>


                                </div>
                            </div>

                            <div class="col-xs-6 col-sm-6 col-md-6">
                  <div class="form-group">
                  <label for="currentcrop">Crop</label>
                  <select class="form-control" id="currentcrop" name="currentcrop" >
                  <option value="Corn">Corn</option>
                  </select>
                  </div>

                </div>


                </div>

                      <fieldset class="scheduler-border">
                          <legend class="scheduler-border">Location and Year</legend>
                          <div class="row">



                             <div class="col-xs-4 col-sm-4 col-md-4">
                    <div class="form-group">
                                      <label for="latitude" > Latitude
                        <a href="http://gps-coordinates.org/my-location.php"  target = "_blank">
                                              <span title="click here on the '?' to find the latitide/longitude of your site" class="glyphicon glyphicon-question-sign"></span></a>
                          </a>
                                      </label>
                                        <input class="form-control" type="text" id="latitude" name="latitude" placeholder ="Latitude of your farm location (optional) ">
                    </div>
                             </div>

                                <div class="col-xs-4 col-sm-4 col-md-4">
                                        <label for ="longitude"> Longitude
                                             <a href="http://gps-coordinates.org/my-location.php"  target = "_blank">
                                              <span title="click here on the '?' to find the latitide/longitude of your site" class="glyphicon glyphicon-question-sign"></span></a>
                          </a>
                                         </label>
                    <div class="form-group">
                    <input class="form-control" type="text" id="longitude" name="longitude" placeholder ="Longitude of your farm (optional)">
                    </div>
                            </div>

                            <div class="col-xs-4 col-sm-4 col-md-4">
                    <div class="form-group">
                        <label for="season">Growing Season
                                                <span title="the growing year" class="glyphicon glyphicon-question-sign"></span>
                                            </label>
                      <select class="form-control" id="season" name="season" >

                      </select>
                    </div>
                            </div>




                          </div>


                      </fieldset>

                       <fieldset class="scheduler-border">

                            <legend class="scheduler-border"> Soil and Climate</legend>
                                                         <div class="row">


                                <div class="col-xs-12 col-sm-12 col-md-12">
                    <div class="form-group">

                                    <div class="row">

                                         <div class="col-md-6">
                                             <label for="tillage">Tillage System
                                                 <a href="description#tillage"  target = "_blank">
                                                <span title="The applied tillage system at the farm" class="glyphicon glyphicon-question-sign">
                                                </span>
                                                 </a>
                                             </label>


                                             <div class="modal fade" id="max_min_tillType" tabindex="-1" role="dialog" aria-labelledby="max_min_tillType" aria-hidden="true">
                                                      <div class="modal-dialog modal-md" role="document">
                                                        <div class="modal-content">
                                                          <div class="modal-header">
                                                            <h5 class="modal-title font-weight-bold">Tillage System Settings
                                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                              <span aria-hidden="true">&times;</span>
                                                            </button>
                                                            </h5>

                                                          </div>
                                                          <div class="modal-body">
                                                              <div class="form-group align-center">
                                                                  <div class="row">
                                                                      <div class="col-md-8">


                                                              <label for="tillage"> </label>

                                                                <select class="form-control" id="tillTypeCat1" name="tillType" placeholder="Till Type" readonly>

                                                                    <option selected="selected" value="1">Min Soil Distortion (No till)</option>


                                                                 </select>
                                                                      </div>

                                                                          <div class="col-md-4">
                                                                  <label for="tillage">Relative Value (0-1)

                                                </label>
                                                <input type="number" data-bind="value: maxTillTypek" id = "tillTypeMax" name="tillTypeNoTill" class="form-control" style="padding: 6px 4px;">
                                                                              </div>
                                                                      </div>

                                                              </div>
                                                              <div class="form-group align-center">
                                                                  <div class="row">
                                                                      <div class="col-md-8">
                                                              <label for="tillage"></label>

                                                                <select class="form-control" id="tillTypeCat1" placeholder="Till Type" readonly>
                                                                    <option value="0" selected="selected">Max Soil Distortion (Conventional)</option>


                                                                 </select>
                                                                          </div>

                                                                          <div class="col-md-4">
                                                                            <label for="tillage">Relative Value (0-1)

                                                </label>
                                                <input type="number" value="" data-bind="value: minTillTypek" id = "tillTypeMin" name="tillTypeConvTill" class="form-control" style="padding: 6px 4px;">
                                                                              </div>
                                                                      </div>

                                                              </div>
                                                          </div>
                                                          <div class="modal-footer">
                                                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                                            <button type="button" class="btn btn-primary">Set</button>
                                                          </div>
                                                        </div>
                                                      </div>
                                                    </div>


                                             <select class="form-control" data-bind="value: tillTypek" id="tillType" placeholder="Till Type">

                                                <option value="" data-bind="value: maxTillTypek" selected="selected">Min Soil Distortion (No till)</option>
                                                 <option value="" data-bind="value: minTillTypek">Max Soil Distortion</option>

                                             </select>
                                         </div>


                                         <div class="col-md-6">
                                                <label for="tillage">Relative Value (0-1)

                                                </label>

                                                <label  for="tillage" class="pull-right">
                                                    <a href="" class="align-center" data-toggle="modal" data-target="#max_min_tillType">Setup</a>


                                                </label>
                                             <input type="number" data-bind="value: tillTypeScalek" value="" id = "tillTypeScale" class="form-control" style="padding: 6px 4px;" readonly>

                                            </div>

                    </div>
                                    </div>
                   </div>
                                  </div>




                            <div class="row">
                                 <div class="col-xs-12 col-sm-12 col-md-12">
                    <div class="form-group">

                                        <div class="row">


                                           <div class="col-md-6 ">
                                               <label for="previouscrop">Contribution from Previous Crop
                                                    <a href="description#previouscrop"  target = "_blank">
                                                        <span title="Previous harvested crop at the farm" class="glyphicon glyphicon-question-sign"></span>
                                                    </a>
                                                </label>


                                               <div class="modal fade" id="max_min_prevCrop" tabindex="-1" role="dialog" aria-labelledby="max_min_prevCrop" aria-hidden="true">
                                                      <div class="modal-dialog modal-md" role="document">
                                                        <div class="modal-content">
                                                          <div class="modal-header">
                                                            <h5 class="modal-title font-weight-bold">Previous Crop Contribution Settings
                                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                              <span aria-hidden="true">&times;</span>
                                                            </button>
                                                            </h5>

                                                          </div>
                                                          <div class="modal-body">
                                                              <div class="form-group align-center">
                                                                  <div class="row">
                                                                      <div class="col-md-8">


                                                              <select class="form-control" id="prevCrop" name="prevCrop" readonly>

                                                <!--categorize all the crops according ot its nutrient contribution such as
                                                (Low: corn, cereals, Moderate: Soybean, forage and Strong: Grass, GreenPeas)  -->

                                             <option  selected="selected"> Strong nutrient contribution (e.g., Legumes, GreenPeas etc.) </option>
                                        </select>
                                                                      </div>

                                                                          <div class="col-md-4">
                                                                  <label for="previousCrop">Relative Value (0-1)

                                                </label>
                                                <input type="number" data-bind="value: highPrevCrop" id = "prevCropMax" name="prevCropHigh" class="form-control" style="padding: 6px 4px;">
                                                                              </div>
                                                                      </div>

                                                              </div>
                                                              <div class="form-group align-center">
                                                                  <div class="row">
                                                                      <div class="col-md-8">

                                                              <select class="form-control" id="prevCrop" name="prevCrop" readonly>

                                                <!--categorize all the crops according ot its nutrient contribution such as
                                                (Low: corn, cereals, Moderate: Soybean, forage and Strong: Grass, GreenPeas)  -->

                                            <option   >Moderate nutrient contribution (e.g., Soybean, Forage etc.)</option>

                                        </select>
                                                                          </div>

                                                                          <div class="col-md-4">
                                                                               <label for="previousCrop">Relative Value (0-1)

                                                </label>
                                            <input type="number" data-bind="value: modPrevCrop" id = "prevCropMin" name="prevCropMod" class="form-control" style="padding: 6px 4px;">
                                                                              </div>
                                                                      </div>

                                                              </div>
                                                               <div class="form-group align-center">
                                                                  <div class="row">
                                                                      <div class="col-md-8">

                                                              <select class="form-control" id="prevCrop" name="prevCrop" readonly>

                                                <!--categorize all the crops according ot its nutrient contribution such as
                                                (Low: corn, cereals, Moderate: Soybean, forage and Strong: Grass, GreenPeas)  -->

                                             <option >Low nutrient contribution (e.g., Corn, Potatoes etc.)</option>
                                       </select>
                                                                          </div>

                                                                          <div class="col-md-4">
                                                                        <label for="previousCrop">Relative Value (0-1)

                                                </label>
                                            <input type="number" data-bind="value: lowPrevCrop" id = "prevCropValue1" name="prevCropLow" class="form-control" style="padding: 6px 4px;">
                                                                              </div>
                                                                      </div>

                                                              </div>
                                                          </div>
                                                          <div class="modal-footer">
                                                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                                            <button type="button" class="btn btn-primary">Set</button>
                                                          </div>
                                                        </div>
                                                      </div>
                                                    </div>


                                               <select data-bind="value: prevCropSelected" class="form-control" id="prevCrop" name="prevCrop">

                                                <!--categorize all the crops according ot its nutrient contribution such as
                                                (Low: corn, cereals, Moderate: Soybean, forage and Strong: Grass, GreenPeas)  -->
                                                <option data-bind="value: lowPrevCrop">Low nutrient contribution (e.g., Corn, Potatoes etc.)</option>
                                            <option selected="selected"  data-bind="value: modPrevCrop">Moderate nutrient contribution (e.g., Soybean, Forage etc.)</option>
                                             <option data-bind="value: highPrevCrop"> Strong nutrient contribution (e.g., Legumes, GreenPeas etc.) </option>



                                            </select>
                                           </div>
                                            <!--
                                           <div class="col-md-5">
                                                <div class="row">
                                                <div class="col-md-6">
                                                    <label  for="previousCrop">Value</label>
                                                </div>
                                                <div class="col-md-6">
                                                    <label  for="previousCrop">
                                                    <a href="" class="align-center" data-toggle="modal" data-target="#max_min_prevCrop">Set Max/Min</a>


                                                </label>
                                                </div>
                                                </div>
                                                <div class="modal fade" id="max_min_prevCrop" tabindex="-1" role="dialog" aria-labelledby="max_min_prevCrop" aria-hidden="true">
                                                      <div class="modal-dialog modal-sm" role="document">
                                                        <div class="modal-content">
                                                          <div class="modal-header">
                                                            <h5 class="modal-title font-weight-bold">Set Previous Crop Max and Min Values
                                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                              <span aria-hidden="true">&times;</span>
                                                            </button>
                                                            </h5>

                                                          </div>
                                                          <div class="modal-body">
                                                              <div class="form-group align-center">
                                                              <label for="previousCrop">Max</label>

                                                                <input class="form-control" id = "prevCropMax" type="number" value="5">

                                                              </div>
                                                              <div class="form-group align-center">
                                                              <label for="previousCrop">Min</label>

                                                                <input class="form-control" id = "prevCropMin" type="number" value="3">

                                                              </div>
                                                          </div>
                                                          <div class="modal-footer">
                                                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                                            <button type="button" class="btn btn-primary">Set</button>
                                                          </div>
                                                        </div>
                                                      </div>
                                                    </div>



                                                <input class="form-control" id = "prevCropValue" name="prevCropValue" type="number">
                                            </div>
                                            -->
                                           <div class="col-md-6">
                                                <label for="previousCrop">Relative Value (0-1)

                                                </label>
                                               <label  for="previousCrop" class="pull-right">
                                                    <a href="" class="align-center" data-toggle="modal" data-target="#max_min_prevCrop">Setup</a>


                                                </label>
                                                <input type="number" data-bind="value: prevCropScalek" id = "prevCropScale" class="form-control" style="padding: 6px 4px;" readonly>

                                            </div>

                                        </div>

                    </div>
                                     </div>
                                </div>

                           <div class="row">

                                 <div class="col-xs-12 col-sm-12 col-md-12">
                    <div class="form-group">

                                        <div class="row">
                                            <div class="col-md-5">
                                                <label for="soiltype">Soil Texture Class Expressed as Clay Ratio
                                                    <a href="http://www.info-sols.ca"  target = "_blank">
                                                  <span title="Click on the ? to lookup your site specific soil type" class="glyphicon glyphicon-question-sign"></span></a>
                                                </label>

                                                <select class="form-control" id="soilType" name="soilType">
                                                    <option value="0.6667" selected="selected">Clay</option>
                                                    <option value="0.5">Clay loam</option>
                                                    <option value="0.0556">Fine sand</option>
                                                    <option value="0.1781">Fine sandy loam</option>
                                                    <option value="0.8824">Heavy clay</option>
                                                    <option value="0.3077">Loam</option>
                                                    <option value="0.0805">Loamy fine sand</option>
                                                    <option value="0.0805">Loamy sand</option>
                                                    <option value="0.0323">Sand</option>
                                                    <option value="0.4211">Sandy clay</option>
                                                    <option value="0.3333">Sandy clay loam</option>
                                                    <option value="0.1333">Sandy loam</option>
                                                    <option value="0.3077">Silt loam</option>
                                                    <option value="0.8182">Silty clay</option>
                                                    <option value="0.7778">Silty clay loam</option>
                                                    <option value="other">Other</option>

                                                </select>


                                                <div class="modal fade" id="max_min_soilType" tabindex="-1" role="dialog" aria-labelledby="max_min_soilType" aria-hidden="true">
                                                      <div class="modal-dialog modal-md" role="document">
                                                        <div class="modal-content">
                                                          <div class="modal-header">
                                                            <h5 class="modal-title font-weight-bold">Clay Ratio Settings
                                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                              <span aria-hidden="true">&times;</span>
                                                            </button>
                                                            </h5>

                                                          </div>
                                                          <div class="modal-body">
                                                              <div class="form-group align-center">
                                                                  <div class="row">
                                                                      <div class="col-md-8">


                                                              <label for="soilType">Max</label>

                                                                <input step="0.0001" class="form-control" id = "soilTypeMax"  name="soilTypeMax" type="number" value="5">
                                                                      </div>

                                                                          <div class="col-md-4">
                                                                  <label for="local climate">Clay Ratio (%)


                                                </label>
                                                <input type="number" value="1" id = "soilTypeValue1" class="form-control" style="padding: 6px 4px;" readonly>
                                                                              </div>
                                                                      </div>

                                                              </div>
                                                              <div class="form-group align-center">
                                                                  <div class="row">
                                                                      <div class="col-md-8">
                                                              <label for="soilType">Min</label>

                                                                <input step="0.0001" class="form-control" id = "soilTypeMin" name="soilTypeMin" type="number" value="3">
                                                                          </div>

                                                                      <div class="col-md-4">
                                                                        <label for="local climate">Scaled Value (0-1)

                                                </label>
                                                <input type="number" value="1" id = "soilTypeScale1" class="form-control" style="padding: 6px 4px;" readonly>
                                                                              </div>
                                                                      </div>

                                                              </div>
                                                          </div>
                                                          <div class="modal-footer">
                                                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                                            <button type="button" class="btn btn-primary">Set</button>
                                                          </div>
                                                        </div>
                                                      </div>
                                                    </div>
                                            </div>

                                            <div class="col-md-4">
                                                <div class="row">
                                                <div class="col-md-6">
                                                    <label  for="soiltype">Clay Ratio (%)</label>
                                                </div>
                                                <div class="col-md-6">

                                                </div>
                                                </div>
                                                <input type="number" value="1" step="0.0001" id = "soilTypeValue" name="soilTypeValue" class="form-control" style="padding: 6px 4px;">
                                            </div>
                                            <!--
                                            <div class="col-md-5">
                                                <div class="row">
                                                <div class="col-md-6">
                                                    <label  for="soiltype">Clay Ratio
                                                    <a href="http://www.info-sols.ca"  target = "_blank">
                                                  <span title="Click on the ? to lookup your site specific soil type" class="glyphicon glyphicon-question-sign"></span></a></label>
                                                </div>
                                                <div class="col-md-6">
                                                    <label  for="soiltype">
                                                    <a href="" class="align-center" data-toggle="modal" data-target="#max_min_soilType"> Set Scale</a>



                                                </label>
                                                </div>
                                                </div>
                                                <div class="modal fade" id="max_min_soilType" tabindex="-1" role="dialog" aria-labelledby="max_min_soilType" aria-hidden="true">
                                                      <div class="modal-dialog modal-sm" role="document">
                                                        <div class="modal-content">
                                                          <div class="modal-header">
                                                            <h5 class="modal-title font-weight-bold">Set Soil Type Scale
                                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                              <span aria-hidden="true">&times;</span>
                                                            </button>
                                                            </h5>

                                                          </div>
                                                          <div class="modal-body">
                                                              <div class="form-group align-center">
                                                              <label for="soilType">Max</label>

                                                                <input class="form-control" id = "soilTypeMax" type="number" value="5">

                                                              </div>
                                                              <div class="form-group align-center">
                                                              <label for="soilType">Min</label>

                                                                <input class="form-control" id = "soilTypeMin" type="number" value="3">

                                                              </div>
                                                          </div>
                                                          <div class="modal-footer">
                                                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                                            <button type="button" class="btn btn-primary">Set</button>
                                                          </div>
                                                        </div>
                                                      </div>
                                                    </div>



                                                <input class="form-control" id = "soilTypeValue" name="soilTypeValue" type="number">
                                            </div>
                                            -->
                                           <div class="col-md-3">
                                                <label for="soilType">Scaled Value (0-1)

                                                </label>
                                               <label  for="soiltype" class="pull-right">
                                                    <a href="" class="align-center" data-toggle="modal" data-target="#max_min_soilType"> Setup</a>
                                                </label>
                                                <input type="number" value="" id = "soilTypeScale" class="form-control" style="padding: 6px 4px;" readonly>

                                            </div>


                                        </div>
                                        </div>
                                     </div>
                                </div>


                              <div class="row">
                                <div class="col-xs-12 col-sm-12 col-md-12">
                  <div class="form-group">


                                         <div class="row">
                                             <div class="col-md-5">
                                                 <label for="som" > Contribution from Soil Organic Matter (SOM)
                                                        <a>
                                                       <span title="The soil organic mattter of your farm's soil" class="glyphicon glyphicon-question-sign"></span>
                                                     </a>
                                                 </label>


                                              <select class="form-control" id="som" name="som" >
                                                <option value="1">Very Low (0% - 2%)</option>
                                                <option value="3">Low (2% - 4%)</option>
                                                 <option selected="selected" value="5">Medium (4% - 6%)</option>
                                                 <option value="8">High (6% - 10%)</option>
                                                 <option value="12">Very High (> 10%)</option>
                                                  <option value="other">Other</option>
                                                </select>
                                                <!-- <input class="form-control" type="number" min="1" max="15" step="0.5"id="somother" name="somother" placeholder="e.g., 2, 4, 6 ... 12"> -->
                                             </div>

                                             <div class="col-md-4">
                                                <div class="row">
                                                <div class="col-md-6">
                                                    <label  for="som">SOM (%)</label>
                                                </div>
                                                <div class="col-md-6">

                                                </div>
                                                </div>

                                                <div class="modal fade" id="max_min_som" tabindex="-1" role="dialog" aria-labelledby="max_min_som" aria-hidden="true">
                                                      <div class="modal-dialog modal-md" role="document">
                                                        <div class="modal-content">
                                                          <div class="modal-header">
                                                            <h5 class="modal-title font-weight-bold">Soil Organic Matter Contribution Settings
                                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                              <span aria-hidden="true">&times;</span>
                                                            </button>
                                                            </h5>

                                                          </div>
                                                          <div class="modal-body">
                                                              <div class="form-group align-center">
                                                                  <div class="row">
                                                                      <div class="col-md-8">


                                                              <label for="som">Max</label>

                                                                <input step="0.01" class="form-control" id = "somMax"  name="somMax" type="number" value="5">
                                                                      </div>

                                                                          <div class="col-md-4">
                                                                  <label for="som">SOM (%)

                                                </label>
                                                <input type="number" id = "somValue1" class="form-control" style="padding: 6px 4px;" readonly>
                                                                              </div>


                                                                      </div>

                                                              </div>
                                                              <div class="form-group align-center">
                                                                  <div class="row">
                                                                      <div class="col-md-8">
                                                              <label for="som">Min</label>

                                                                <input step="0.01" for="som" class="form-control" id = "somMin" name="somMin" type="number" value="3">
                                                                          </div>

                                                                          <div class="col-md-4">
                                                                                <label for="som">Scaled Value (0-1)

                                                </label>
                                                <input type="number" value="1" id = "somScale1" class="form-control" style="padding: 6px 4px;" readonly>
                                                                              </div>
                                                                      </div>

                                                              </div>
                                                          </div>
                                                          <div class="modal-footer">
                                                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                                            <button type="button" class="btn btn-primary">Set</button>
                                                          </div>
                                                        </div>
                                                      </div>
                                                    </div>
                                                 <input step="0.01" class="form-control" id = "somValue" name="somValue" type="number">




                                             </div>
                                             <div class="col-md-3">
                                                <label for="som">Scaled Value (0-1)

                                                </label>
                                                 <label  for="som" class="pull-right">
                                                    <a href="" class="align-center" data-toggle="modal" data-target="#max_min_som">Setup</a>


                                                </label>
                                                <input type="number" value="1" id = "somScale" class="form-control" style="padding: 6px 4px;" readonly>

                                            </div>

                  </div>

                </div>
                                </div>
                              </div>



                            <div class="row">
                  <div class="col-xs-12 col-sm-12 col-md-12">
                    <div class="form-group">


                                        <div class="row">
                                            <div class="col-md-5">
                                                <label for="local climate">Precipitation Expressed as Abundant and Well Distributed Rainfall (AWDR)
                                                    <a href="description#precipitation"  target = "_blank">
                                                    <span title="The rain forecast at the farm region" class="glyphicon glyphicon-question-sign">

                                                    </span>
                                                    </a>
                                                </label>

                                                <select class="form-control" id="climate" name="climate" >
                                                    <option value="15">Very Dry </option>
                                                    <option value="45">Dry </option>
                                                    <option selected="selected" value="75">Medium Conditions</option>
                                                    <option value="105">Wet </option>
                                                    <option value="135">Very Wet </option>
                                                    <option value="other">Other</option>
                                                </select>
                                                <!-- <input class="form-control" type="number"  step="5" min="0" max="150" id="awdrother" name="awdrother" placeholder="e.g., 30, 50, 90, 120 ... 150 mm"> -->
                                            </div>
                                            <div class="col-md-4">
                                                <div class="row">
                                                <div class="col-md-6">
                                                    <label  for="local climate">AWDR, mm</label>
                                                </div>
                                                <div class="col-md-6">

                                                </div>
                                                </div>
                                                <div class="modal fade" id="max_min_climate" tabindex="-1" role="dialog" aria-labelledby="max_min_climate" aria-hidden="true">
                                                      <div class="modal-dialog modal-md" role="document">
                                                        <div class="modal-content">
                                                          <div class="modal-header">
                                                            <h5 class="modal-title font-weight-bold">Precipitation Settings
                                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                              <span aria-hidden="true">&times;</span>
                                                            </button>
                                                            </h5>

                                                          </div>
                                                          <div class="modal-body">
                                                              <div class="form-group align-center">
                                                                  <div class="row">
                                                                      <div class="col-md-8">


                                                              <label for="climate">Max</label>

                                                                <input step="0.01" class="form-control" id = "climateMax"  name="climateMax" type="number" value="5">
                                                                      </div>

                                                                          <div class="col-md-4">
                                                                            <label for="local climate">AWDR, mm

                                                </label>
                                                <input type="number" id = "climateValue1" class="form-control" style="padding: 6px 4px;" readonly>
                                                                              </div>
                                                                      </div>

                                                              </div>
                                                              <div class="form-group align-center">
                                                                  <div class="row">
                                                                      <div class="col-md-8">
                                                              <label for="local climate">Min</label>

                                                                <input step="0.01" class="form-control" id = "climateMin" name="climateMin" type="number" value="3">
                                                                          </div>

                                                                          <div class="col-md-4">
                                                                              <label for="local climate">Scaled Value (0-1)

                                                </label>
                                                <input type="number" value="1" id = "climateScale1" class="form-control" style="padding: 6px 4px;" readonly>
                                                                              </div>
                                                                      </div>

                                                              </div>
                                                          </div>
                                                          <div class="modal-footer">
                                                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                                            <button type="button" class="btn btn-primary">Set</button>
                                                          </div>
                                                        </div>
                                                      </div>
                                                    </div>



                                                <input class="form-control" id = "climateValue" name="climateValue" type="number">
                                            </div>

                                             <div class="col-md-3">
                                                <label for="local climate">Scaled Value (0-1)

                                                </label>
                                                 <label  for="local climate" class="pull-right">
                                                    <a href="" class="align-center" data-toggle="modal" data-target="#max_min_climate"> Setup</a>


                                                </label>
                                                <input type="number" value="" id = "climateScale" name="climateScale" style="padding: 6px 4px;" class="form-control" readonly>

                                            </div>
                                        </div>
                                    </div>
                  </div>
                            </div>
                            <div class="row">
                                <div class="col-xs-12 col-sm-12 col-md-12">
                    <div class="form-group">


                                    <div class="row">
                                        <div class="col-md-5">
                                            <label for="local climate">Temperature Expressed as Crop Heat Unit (CHU)
                                                  <a href="description#temperature"  target = "_blank">
                                                <span title="The temperature forecast at the farm region" class="glyphicon glyphicon-question-sign"></span>
                                                </a>
                                            </label>

                                            <select for="local climate" class="form-control" id="chu" name="chu" >
                                                 <option value="550">Cold </option>
                                                <option value="650">Warm </option>
                                                <option selected="selected" value="750">Medium Conditions</option>
                                                <option value="850">Hot </option>
                                                <option value="950">Very Hot </option>
                                                <option value="other">Other</option>
                                            </select>

                                            <!-- <input class="form-control" type="number" step="50" min="500" max="1200" id="chuother" name="chuother" placeholder=" e.g., 500, 600, 700 ... 1000 °C"> -->
                                        </div>
                                        <div class="col-md-4">
                                                <div class="row">
                                                <div class="col-md-6">
                                                    <label  for="local climate">CHU, °C</label>
                                                </div>
                                                <div class="col-md-6">

                                                </div>
                                                </div>
                                                <div class="modal fade" id="max_min_chu" tabindex="-1" role="dialog" aria-labelledby="max_min_chu" aria-hidden="true">
                                                      <div class="modal-dialog modal-md" role="document">
                                                        <div class="modal-content">
                                                          <div class="modal-header">
                                                            <h5 class="modal-title font-weight-bold">Temperature Settings
                                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                              <span aria-hidden="true">&times;</span>
                                                            </button>
                                                            </h5>

                                                          </div>
                                                          <div class="modal-body">
                                                              <div class="form-group align-center">
                                                                  <div class="row">
                                                                      <div class="col-md-8">


                                                              <label for="chu">Max</label>

                                                                <input for="local climate" class="form-control" id = "chuMax"  name="chuMax" type="number" value="5">
                                                                      </div>

                                                                          <div class="col-md-4">
                                                                  <label for="local climate">CHU, °C

                                                </label>
                                                <input type="number" for="local climate" id = "chuValue1" class="form-control" style="padding: 6px 4px;" readonly>
                                                                              </div>
                                                                      </div>

                                                              </div>
                                                              <div class="form-group align-center">
                                                                  <div class="row">
                                                                      <div class="col-md-8">
                                                              <label for="local climate">Min</label>

                                                                <input class="form-control" id = "chuMin" name="chuMin" type="number" value = "3">
                                                                          </div>

                                                                          <div class="col-md-4">
                                                                            <label for="local climate">Scaled Value (0-1)

                                                </label>
                                                <input type="number" value="1" id = "chuScale1" class="form-control" style="padding: 6px 4px;" readonly>
                                                                              </div>
                                                                      </div>

                                                              </div>
                                                          </div>
                                                          <div class="modal-footer">
                                                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                                            <button type="button" class="btn btn-primary">Set</button>
                                                          </div>
                                                        </div>
                                                      </div>
                                                    </div>



                                                <input class="form-control" id = "chuValue" name="chuValue" type="number">
                                            </div>

                                        <div class="col-md-3">
                                                <label for="local climate">Scaled Value (0-1)

                                                </label>
                                                <label  for="local climate" class="pull-right">
                                                    <a href="" class="align-center" data-toggle="modal" data-target="#max_min_chu">Setup</a>


                                                </label>
                                                <input type="number"for="local climate"  value="" id = "chuScale" class="form-control" style="padding: 6px 4px;" readonly>

                                        </div>
                                    </div>
                                    </div>
                  </div>
                            </div>

                           <script>

                               var categories = ["soilType","prevCrop","tillType","som","climate","chu"];

                                   var ScaleCalc = function (item) {
                                    return function(){
                                        if(document.getElementById(item + "Value")) {
                                            var val = document.getElementById(item + "Value").value;

                                        }
                                        else{
                                            var val = document.getElementById(item).value;

                                        }
                                       var min = document.getElementById(item + "Min").value;
                                       console.log(min);
                                       var max = document.getElementById(item + "Max").value;

                                       var scale = +(((val - min) / (max - min)).toFixed(2));

                                       var scaleElem = document.getElementById(item + "Scale");
                                       if(document.getElementById(item + "Scale1")) {
                                           var scaleElem1 = document.getElementById(item + "Scale1");
                                           scaleElem1.value = scale;
                                       }
                                       scaleElem.value = scale;


                                     }
                                   };
                                   var SetValue = function (item) {
                                    return function(){

                                      var cat = document.getElementById(item);
                                      var value = document.getElementById(item + "Value");
                                      var value1 = document.getElementById(item + "Value1");
                                      value.value = cat.value;
                                      value1.value = cat.value;

                                    }

                                   };


                                   var SetCat = function(item){
                                      return function(){
                                        var cat = document.getElementById(item);
                                        var value = document.getElementById(item + "Value");
                                        var value1 = document.getElementById(item + "Value1");
                                        value1.value = value.value;
                                        for(i=0;i<cat.length;i++){
                                          if(cat.options[i].value == value.value){
                                              cat.value = cat.options[i].value;
                                              break;
                                          }
                                          else{
                                              cat.value = "other"
                                          }
                                        }
                                      }
                                   };


                               for (i = 0; i<categories.length;i++) {
                                   (function(i) {


                                       if(document.getElementById(categories[i] + "Value")) {
                                           $("#" + categories[i]).change(SetValue(categories[i]));
                                           $(document).ready(SetValue(categories[i]));
                                       }
                                       $("#" + categories[i]).change(ScaleCalc(categories[i]));
                                       $("#" + categories[i] + "Value").change(SetCat(categories[i]));
                                       $("#" + categories[i] + "Value").change(ScaleCalc(categories[i]));
                                       $("#" + categories[i] + "Min").change(ScaleCalc(categories[i]));
                                       $("#" + categories[i] + "Max").change(ScaleCalc(categories[i]));
                                       $(document).ready(ScaleCalc(categories[i]));

                                   })(i);
                               }
                               $( window ).on( "load", function() {

                                   $("#soilTypeValue").val({{ userClayRatio }});
                                   $("#soilType").val({{ userClayRatio }});
                                   $("#somValue").val({{ userSOM }});
                                   $("#som").val({{ userSOM }});
                                   $("#chuValue").val({{ userCHU }});
                                   $("#chu").val({{ userCHU }});
                                   $("#climateValue").val({{ userAWDR }});
                                   $("#climate").val({{ userAWDR }});

                               });
                               for (i = 0; i<categories.length;i++) {
                                   (function(i) {
                                       $(window).on("load",ScaleCalc(categories[i]));

                                       })(i);
                                   }






                           </script>







                       </fieldset>


                         <fieldset class="scheduler-border">
                             <legend class="scheduler-border"> Price and Cost</legend>
                             <div class="row">


                  <div class="col-xs-6 col-sm-6 col-md-6">
                                        <label for="price">Yield Price (USD) $/t: Mean
                                         <a>
                                             <span title="The average mean price of selected crop price" class="glyphicon glyphicon-question-sign"></span>
                                         </a>
                                        </label>
                    <div class="form-group">
                    <input class="form-control" type="number"  step="0.01" id="meanprice" name="meanprice" placeholder ="Mean" value="{{ cornPrice.mean }}">
                    </div>
                  </div>

                                 <div class="col-xs-6 col-sm-6 col-md-6">
                                        <label for="price">Yield Price (USD) $/t: Standard Deviation
                                        <a>
                                             <span title="The average standard deviation of price of selected crop" class="glyphicon glyphicon-question-sign"></span>

                                        </a>
                                        </label>
                    <div class="form-group">
                    <input class="form-control" type="number"  step="0.01" id="stdprice" name="stdprice" placeholder ="Standard Deviation" value="{{ cornPrice.std }}">
                    </div>
                  </div>



            </div>

                        <div class="row">

                            <div class="col-xs-6 col-sm-6 col-md-6">
                                        <label for="meancost">Fertilizer Cost (USD) $/kg: Mean
                                              <a>
                                            <span title="The average mean cost of selected fertilizer" class="glyphicon glyphicon-question-sign"></span>
                                              </a>

                                        </label>
                    <div class="form-group">
                      <input class="form-control" type="number" step="0.01" id="meancost" name="meancost" placeholder ="Mean" value="{{ Ncost.mean }}">
                    </div>
                  </div>


                            <div class="col-xs-6 col-sm-6 col-md-6">
                                        <label for="stdcost">Fertilizer Cost (USD) $/kg: Standard Deviation
                                            <a>
                                        <span title="The average standard deviation of selected fertilizer cost" class="glyphicon glyphicon-question-sign"></span>
                                        </a>
                                        </label>
                    <div class="form-group">
                    <input class="form-control" type="number" step="0.01"  id="stdcost"  name ="stdcost" placeholder ="Standard Deviation" value="{{ Ncost.std}}">
                    </div>
                  </div>

                        </div>
                         </fieldset>
                            <br>
                <button class="btn btn-md btn-primary btn-block" type="submit">Submit</button>

              </form>

            </div>
          </div>
            {% endblock %}



    </div> <!-- /container -->
    {% include "passapp/footer.html" %}
  </body>
  <script>
      ko.applyBindings(ViewModel);

  </script>


</html>
